<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SITTA - Sistem Pemesanan Bahan Ajar UT</title>

  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/stok.css">
  <link rel="stylesheet" href="css/header.css">
</head>

<body> <div id="stok-app">

  <header>
    <nav class="main-header-nav">

      <div class="nav-left">
        <a href="dashboard.html">
          <img src="https://www.ut.ac.id/wp-content/uploads/2023/08/UT_Header.webp" alt="Logo Universitas Terbuka"
            class="logo">
        </a>
      </div>

      <div class="nav-center">
        <ul class="nav-menu">
          <li><a href="stok.html">Informasi Bahan Ajar</a></li>
          <li><a href="tracking.html">Tracking Pengiriman</a></li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle">Laporan â–¾</a>
            <ul class="dropdown-menu">
              <li><a href="#">Monitoring Progress DO</a></li>
              <li><a href="#">Rekap Bahan Ajar</a></li>
            </ul>
          </li>
          <li><a href="#">Histori Transaksi</a></li>
        </ul>
      </div>

      <div class="nav-right">
        <div id="liveClock" class="clock-display"></div>
        <img src="img/pp.jpg" alt="Foto Profil" class="profile-pic">
        <span id="userNameDisplay">...</span>
        <button id="logoutBtn" class="logout-btn">Logout</button>
      </div>

    </nav>
  </header>

  <main>

    <section class="banner">

      <div class="banner-content">
        <h1>Informasi Bahan Ajar</h1>
        <p class="subtitle">Kelola dan lihat ketersediaan stok bahan ajar di berbagai lokasi.</p>
        <button 
        id="openAddStokModalBtn" 
        class="open-modal-btn" 
        type="button" 
        @click="bukaModeTambah">
        Tambah Data Buku Baru
        </button>
        <div class="filter-container">
            <h4>Filter dan Urutkan</h4>
            <div class="filter-controls">
                
                <div>
                    <label for="filter-lokasi">Lokasi (UT-Daerah):</label>
                    <select id="filter-lokasi" v-model="filterLokasi">
                        <option value="">Semua Lokasi</option>
                        <option v-for="lokasi in upbjjList" :value="lokasi">{{ lokasi }}</option>
                    </select>
                </div>
                    
                <div>
                    <label for="filter-kategori">Kategori:</label>
                    <select id="filter-kategori" v-model="filterKategori">
                        <option value="">Semua Kategori</option>
                        <option v-for="kategori in kategoriList" :value="kategori">{{ kategori }}</option>
                    </select>
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" v-model="filterHanyaMenipis">
                        Hanya tampilkan stok menipis/kosong
                    </label>
                </div>
                
                <div>
                    <label for="sort-by">Urutkan Berdasarkan:</label>
                    <select id="sort-by" v-model="urutkanBerdasarkan">
                        <option value="judul">Judul (A-Z)</option>
                        <option value="harga">Harga (Termurah)</option>
                        <option value="stok">Stok (Tersedikit)</option>
                    </select>
                </div>

                <div>
                    <button type="button" @click="resetFilter">Reset Filter</button>
                </div>
                
            </div>
        </div>  
      </div>

      <div class="stok-header-controls">
        <h2>Daftar Stok Saat Ini</h2>
        <section class="card">
          <div id="stokBookGrid" class="stok-grid">
              <article class="book-card" v-for="buku in stokTampil" v-bind:key="buku.kode">

                  <img v-bind:src="buku.cover" v-bind:alt="buku.judul" class="book-card-image">

                  <div class="book-card-content">
                    <h3 class="book-card-title">{{ buku.judul }}</h3>
                    
                    <div class="book-card-details">
                      <span>Kode: {{ buku.kode }}</span>
                      
                      <span>Kategori: {{ buku.kategori }}</span>
                      <span>UPBJJ: {{ buku.upbjj }}</span>
                      <span>Lokasi Rak: {{ buku.lokasiRak }}</span>

                    </div>
                    
                    <div class="book-card-stock" v-bind:class="getStatusClass(buku)">
                      Stok: <span>{{ buku.qty }}</span>
                      <span v-if="buku.qty === 0"> (Kosong)</span>
                      <span v-else-if="buku.qty < buku.safety"> (Menipis!)</span>
                      <span v-else> (Aman)</span>
                    </div>

                    <div class="book-card-price">
                      <strong>Harga: Rp {{ buku.harga }}</strong>
                    </div>

                    <div class="catatan" v-html="buku.catatanHTML"></div>

                    <div class="card-actions">
                        <button @click="bukaModeEdit(buku)" type="button">Edit</button>
                    </div>

                  </div>
              </article>
          </div>
        </section>
      </div>
      
    </section>

  </main>

  <div id="addStokModal" class="modal" v-bind:class="{ 'is-buka': isModalBuka }">
      <div class="modal-content">
        
        <span class="close-btn" @click="tutupModal">&times;</span>

        <form id="addStokForm" @submit.prevent="simpanForm">
          
          <h2>{{ judulModal }}</h2>

          <div class="form-group">
            <label for="kodeBarang">Kode Barang:</label>
            <input type="text" id="kodeBarang" v-model="bukuForm.kode" 
                  v-bind:readonly="modeModal === 'edit'" required>
          </div>
          
          <div class="form-group">
            <label for="namaBarang">Nama Barang (Judul):</label>
            <input type="text" id="namaBarang" v-model="bukuForm.judul" required>
          </div>

          <div class="form-group">
            <label for="kategori">Kategori:</label>
            <select id="kategori" v-model="bukuForm.kategori" required>
              <option value="" disabled>Pilih Kategori</option>
              <option v-for="kat in kategoriList" v-bind:value="kat">{{ kat }}</option>
            </select>
          </div>

          <div class="form-group">
            <label for="upbjj">UPBJJ (Lokasi):</label>
            <select id="upbjj" v-model="bukuForm.upbjj" required>
              <option value="" disabled>Pilih UPBJJ</option>
              <option v-for="lok in upbjjList" v-bind:value="lok">{{ lok }}</option>
            </select>
          </div>

          <div class="form-group">
            <label for="lokasiRak">Lokasi Rak:</label>
            <input type="text" id="lokasiRak" v-model="bukuForm.lokasiRak">
          </div>

          <div class="form-group">
            <label for="harga">Harga:</label>
            <input type="number" id="harga" v-model.number="bukuForm.harga" required>
          </div>

          <div class="form-group">
            <label for="edisi">Edisi:</label>
            <input type="number" id="edisi" v-model.number="bukuForm.edisi" required>
          </div>

          <div class="form-group">
            <label for="stok">Stok (Qty):</label>
            <input type="number" id="stok" v-model.number="bukuForm.qty" required>
          </div>

          <div class="form-group">
            <label for="safety">Safety Stok:</label>
            <input type="number" id="safety" v-model.number="bukuForm.safety" required>
          </div>
          
          <div class="form-group">
            <label for="catatanHTML">Catatan (HTML):</label>
            <input type="text" id="catatanHTML" v-model="bukuForm.catatanHTML">
          </div>
          
          <div class="form-group">
            <label for="cover">URL Cover Gambar:</label>
            <input type="text" id="cover" v-model="bukuForm.cover">
          </div>

          <button type="submit" class="add-btn">
            {{ modeModal === 'tambah' ? 'Tambah Data Baru' : 'Simpan Perubahan' }}
          </button>
        </form>

      </div>
    </div>

  </div>
  <footer>
    <p>&copy; 2025 Universitas Terbuka by I Putu Sugiarta. Hak Cipta Dilindungi.</p>
  </footer>

  <script src="js/vue.js"></script>
  <script src="js/stok-app.js"></script>
  <script src="js/header.js"></script>


</body>

</html>